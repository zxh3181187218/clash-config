# --- åŸºç¡€è®¾ç½® ---
port: 7890
socks-port: 7891
allow-lan: true
mode: rule
log-level: info
ipv6: true  # å¼€å¯ IPv6 æ”¯æŒ (å¿…é¡»ï¼Œå¦åˆ™å¤‡ç”¨èŠ‚ç‚¹æ— æ³•è¿æ¥)
external-controller: 127.0.0.1:9090

# --- DNS è®¾ç½® (ä¿®å¤ç‰ˆï¼šå…¼é¡¾è¿æ¥æ€§ä¸éšç§) ---
dns:
  enable: true
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  ipv6: true
  
  # [1] å¼•å¯¼ DNSï¼šä»…ç”¨äºè§£æâ€œèŠ‚ç‚¹æœ¬èº«çš„åŸŸåâ€
  # å¿…é¡»åŒ…å«å›½å†… DNSï¼Œå¦åˆ™è¿˜æ²¡è¿ä¸Šä»£ç†å°±æ‰¾ä¸åˆ°èŠ‚ç‚¹ IPï¼Œå¯¼è‡´æ‰€æœ‰å¤‡ç”¨èŠ‚ç‚¹å¤±æ•ˆ
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  
  # [2] ä¸»è¦ DNSï¼šä»£ç†è¿ä¸Šåï¼ŒçœŸæ­£æŸ¥è¯¢éšç§æ•°æ®çš„ DNS (åŠ å¯†ä¼ è¾“)
  nameserver:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
    
  # [3] å…œåº• DNS
  fallback:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
    - 223.5.5.5 # é˜²æ­¢å›½å¤– DoH å½»åº•è¿ä¸ä¸Šæ—¶æ–­ç½‘
  
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4

# --- èŠ‚ç‚¹åˆ—è¡¨ ---
proxies:
  # [1] æµ·å¤–ä¸»åŠ›ï¼šå¾·å›½ VLESS (IPv4)
  # æ³¨æ„ï¼šè¿™é‡Œæ˜¯ä½ æ•…æ„æ”¹é”™ IP çš„ç‰ˆæœ¬ (61)ï¼Œä¸ºäº†æµ‹è¯•åˆ‡æ¢åŠŸèƒ½
  # æµ‹è¯•å®Œè®°å¾—æ”¹å› 60
  - name: "ğŸ‡©ğŸ‡ª å¾·å›½ VLESS"
    type: vless
    server: 47.108.130.61  # <--- ç›®å‰æ˜¯é”™è¯¯çš„ IPï¼Œç”¨äºè§¦å‘æ•…éšœè½¬ç§»
    port: 51398
    uuid: 8f800fe3-5af8-4021-cc74-fc159ca640a9
    network: ws
    tls: false
    udp: true
    ws-opts:
      path: "/"
      headers:
        Host: pull.free.video.10010.com

  # [2] æµ·å¤–å¤‡ç”¨ï¼šHy2 (IPv6)
  - name: "ğŸš€ Hy2 å¤‡ç”¨"
    type: hysteria2
    server: ipv6.zxh425.dpdns.org
    port: 443
    password: 9hT3m6FvRkS1e8PnL5
    sni: ipv6.zxh425.dpdns.org
    obfs: salamander
    obfs-password: 8dS6p4JtMwE3q7VkH2
    skip-cert-verify: true

  # [3] æµ·å¤–å…œåº•ï¼šVision (IPv6)
  - name: "â˜ï¸ VLESS Vision"
    type: vless
    server: ipv6.zxh425.dpdns.org
    port: 443
    uuid: 3a7d914d-86d9-4cec-8e65-b08f5c0b98ab
    network: tcp
    tls: true
    udp: true
    flow: xtls-rprx-vision
    servername: gateway.icloud.com
    client-fingerprint: chrome
    reality-opts:
      public-key: IXNtZnkoBPz2Yz-o1Jia8gQLeCj4mh-cszPFQys_OH4
      short-id: f71dda44e6f4f3b7

  # [4] å›½å†…ä¸“çº¿ï¼šæˆéƒ½ VMess
  - name: "ğŸ‡¨ğŸ‡³ å›½å†…ä¸“çº¿ (æˆéƒ½)"
    type: vmess
    server: 47.108.130.60
    port: 25477
    uuid: 8f800fe3-5af8-4021-cc74-fc159ca640a9
    alterId: 0
    cipher: auto
    network: ws
    ws-opts:
      path: "/"
      headers:
        Host: pull.free.video.10010.com

# --- ç­–ç•¥ç»„ ---
proxy-groups:
  # 1. æµ·å¤–æµé‡ç»„ (Fallback æ¨¡å¼)
  # é€»è¾‘ï¼šä¼˜å…ˆæ£€æµ‹ç¬¬ä¸€ä¸ªï¼Œå¦‚æœæŒ‚äº†(Timeout)ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°ç¬¬äºŒä¸ª
  - name: "ğŸ›¡ï¸ æµ·å¤–è‡ªåŠ¨ä»£ç†"
    type: fallback
    proxies:
      - "ğŸ‡©ğŸ‡ª å¾·å›½ VLESS"    # ä¼˜å…ˆçº§ 1
      - "ğŸš€ Hy2 å¤‡ç”¨"      # ä¼˜å…ˆçº§ 2
      - "â˜ï¸ VLESS Vision"  # ä¼˜å…ˆçº§ 3
    url: 'http://www.gstatic.com/generate_204'
    interval: 60

  # 2. å›½å†…æµé‡ç»„ (æŒ‡å®šèµ°æˆéƒ½)
  - name: "ğŸ‡¨ğŸ‡³ å›½å†…ä»£ç†"
    type: select
    proxies:
      - "ğŸ‡¨ğŸ‡³ å›½å†…ä¸“çº¿ (æˆéƒ½)"

# --- è§„åˆ™è®¾ç½® ---
rules:
  # 1. WebRTC é˜»æ–­ (é˜²æ­¢ IP æ³„éœ²)
  - DST-PORT,3478,REJECT
  - DST-PORT,19302,REJECT

  # 2. Spotify åˆ†æµ
  - GEOSITE,spotify,ğŸ›¡ï¸ æµ·å¤–è‡ªåŠ¨ä»£ç†

  # 3. å›½å†…æµé‡ -> èµ°æˆéƒ½èŠ‚ç‚¹
  - GEOSITE,cn,ğŸ‡¨ğŸ‡³ å›½å†…ä»£ç†
  - GEOIP,cn,ğŸ‡¨ğŸ‡³ å›½å†…ä»£ç†
  
  # 4. å…œåº• -> èµ°æµ·å¤–ç»„
  - MATCH,ğŸ›¡ï¸ æµ·å¤–è‡ªåŠ¨ä»£ç†
