# 端口设置
mixed-port: 7890
allow-lan: true
mode: rule
log-level: info
ipv6: false
external-controller: 127.0.0.1:9090

# DNS 设置 (推荐配置，防止 DNS 泄露)
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  fallback:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4

# ---------------------------------------------------
# 节点定义区域
# ---------------------------------------------------
proxies:
  # 1. 成都节点 (作为入口)
  # 注意：必须开启 UDP，因为 Hy2 是 UDP 协议
  - name: "🇨🇳 成都 (入口)"
    type: vmess
    server: 47.108.130.60
    port: 25477
    uuid: 8f800fe3-5af8-4021-cc74-fc159ca640a9
    alterId: 0
    cipher: auto
    network: ws
    udp: true  
    ws-opts:
      path: "/"
      headers:
        Host: pull.free.video.10010.com

  # 2. 美国 Hy2 节点 (作为出口)
  - name: "🇺🇸 美国 Hy2 (出口)"
    type: hysteria2
    server: hy2.zxh425.dpdns.org
    port: 443
    password: "9hT3m6FvRkS1e8PnL5"
    sni: hy2.zxh425.dpdns.org
    obfs: salamander
    obfs-password: "8dS6p4JtMwE3q7VkH2"
    skip-cert-verify: true

# ---------------------------------------------------
# 代理组定义区域 (链式代理逻辑)
# ---------------------------------------------------
proxy-groups:
  # 策略组 1: 主选择器
  - name: "🚀 节点选择"
    type: select
    proxies:
      - "🔗 链式代理(成都->美国)"
      - "🇨🇳 成都 (入口)"
      - "🇺🇸 美国 Hy2 (出口)"
      - DIRECT

  # 策略组 2: 链式代理核心逻辑 (Relay)
  # 流量走向：手机 -> 成都 -> 美国 -> 目标网站
  - name: "🔗 链式代理(成都->美国)"
    type: relay
    proxies:
      - "🇨🇳 成都 (入口)"
      - "🇺🇸 美国 Hy2 (出口)"

  # 策略组 3: 漏网之鱼
  - name: "🐟 漏网之鱼"
    type: select
    proxies:
      - "🚀 节点选择"
      - DIRECT

# ---------------------------------------------------
# 分流规则
# ---------------------------------------------------
rules:
  # 局域网和私有地址直连
  - GEOIP,PRIVATE,DIRECT,no-resolve
  
  # 常见的中国应用直连
  - GEOSITE,CN,DIRECT
  - GEOIP,CN,DIRECT
  
  # 剩下的流量全部走代理
  - MATCH,🚀 节点选择
